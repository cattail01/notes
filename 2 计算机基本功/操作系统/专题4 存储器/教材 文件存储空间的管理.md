[toc]

### 文件存储空间的管理

#### 空闲表法

* 空闲表法：属于**连续分配**方式，为每个文件分配一块连续空间。系统为外存上的所有区建立一张空闲表，**每个空闲区对应一个空闲表项**，每个表项包括表项**序号、空闲区的第一个盘块号和空闲区的盘块数**。

#### 空闲链表法

* 空闲链表法：将文件存储空间中的**所有空闲区连接成一条空闲链表**。

#### 位示图法

* 位示图法：利用**二进制的一位**来表示**一个盘块的使用情况**。
* 位的值为0表示空闲，为1表示分配。
* 由所有盘块所对应的位构成一个集合，称为位示图。

##### 位视图盘块的分配和回收

* 分配：
  * (1) 顺序扫描位示图，从中找出一个或一组其值为“0”的二进制位(“0”表示空闲时)。
  * (2) 转换成与之相应的盘块号。假定二进制位位于位示图的第i行、第j列，则其相应的盘块号：  
  * **b=n(i-1)+j**（b：对应的盘块号；n：一行有多少个；i：行号；j：列号）
  * (3) 修改位示图， 令map[i，j]=1

* 回收
  * (1) 将回收盘块的盘块号转换成位示图中的行号和列号。 转换公式为：
  * **i=(b-1)DIV n+1**
  * **j=(b-1)MOD n+1**
  * (2) 修改位示图。 令map[i，j]=0 

#### 成组链接法

* 将一个文件卷的所有**空闲盘块**分成**固定大小的组**（如100个盘块），将每一组的**盘块号**和**盘块数**记入**前一组的最后一个盘块**中，第一组的盘块数和盘块号记入**空闲盘块栈**中。
  * head{num, id0_next_id, id1, ..., id99 } -> struct{num, id0_next_id, id1, ..., id99}
  * 其中：num代表这个组内剩余的盘块数量；id0_next_id代表下一个记录盘块的位置；id1, ..., id99代表这个组的空闲盘块编号

